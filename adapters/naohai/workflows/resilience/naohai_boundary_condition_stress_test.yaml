workflow:
  name: "naohai_boundary_condition_stress_test"
  description: "é—¹æµ·è¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼šè¾“å…¥éªŒè¯ã€èµ„æºçº¦æŸã€é”™è¯¯æ¢å¤çš„å…¨é¢éªŒè¯"
  version: "boundary-v1.0"
  timeout: 480000  # 8åˆ†é’Ÿè¶…æ—¶

  # è¾¹ç•Œæ¡ä»¶æµ‹è¯•åˆå§‹åŒ–
  suite_setup:
    - action: "open_site"
      url: "${test.url}"
      timeout: ${test.timeout.page_load}

    - action: "navigate_to_ai_create"
      timeout: ${test.timeout.navigation}

  # è¾¹ç•Œæ¡ä»¶æµ‹è¯•åœºæ™¯
  phases:
    # åœºæ™¯1: è¾“å…¥éªŒè¯è¾¹ç•Œæµ‹è¯•
    - name: "input_validation_boundary_test"
      description: "æµ‹è¯•å„ç§è¾“å…¥è¾¹ç•Œæ¡ä»¶"
      steps:
        # è¶…é•¿æ–‡æœ¬è¾“å…¥æµ‹è¯•
        - action: "test_text_input_boundaries"
          test_cases:
            - name: "æçŸ­æ–‡æœ¬"
              input: "A"
              expected_result: "accept"
            - name: "è¾¹ç•Œé•¿åº¦æ–‡æœ¬"
              input: "${generate.string.length_1000}"
              expected_result: "accept"
            - name: "è¶…é•¿æ–‡æœ¬"
              input: "${generate.string.length_10000}"
              expected_result: "reject_or_truncate"
            - name: "ç©ºæ–‡æœ¬"
              input: ""
              expected_result: "reject"
            - name: "åªæœ‰ç©ºæ ¼"
              input: "     "
              expected_result: "trim_or_reject"

        # ç‰¹æ®Šå­—ç¬¦å¤„ç†æµ‹è¯•
        - action: "test_special_character_handling"
          test_cases:
            - name: "HTMLæ ‡ç­¾"
              input: "<script>alert('test')</script>"
              expected_behavior: "escape_or_reject"
            - name: "SQLæ³¨å…¥å°è¯•"
              input: "'; DROP TABLE users; --"
              expected_behavior: "escape_or_reject"
            - name: "Unicodeå­—ç¬¦"
              input: "ğŸ¬ğŸ“âœ¨ä¸­æ–‡å­—ç¬¦æµ‹è¯•"
              expected_result: "accept"
            - name: "æ§åˆ¶å­—ç¬¦"
              input: "${generate.control_characters}"
              expected_behavior: "escape_or_remove"
            - name: "é›¶å®½åº¦å­—ç¬¦"
              input: "${generate.zero_width_chars}"
              expected_behavior: "preserve_or_remove"

        - action: "screenshot"
          name: "input_validation_completed"
          save_path: "screenshots/boundary/input_validation.png"

    # åœºæ™¯2: æ–‡ä»¶å¤§å°å’Œæ ¼å¼è¾¹ç•Œæµ‹è¯•
    - name: "file_boundary_test"
      description: "æµ‹è¯•æ–‡ä»¶ä¸Šä¼ çš„å¤§å°å’Œæ ¼å¼è¾¹ç•Œ"
      steps:
        # æ–‡ä»¶å¤§å°è¾¹ç•Œæµ‹è¯•
        - action: "test_file_size_boundaries"
          test_cases:
            - name: "ç©ºæ–‡ä»¶"
              size: 0
              expected_result: "reject"
            - name: "æå°æ–‡ä»¶"
              size: 1
              expected_result: "accept"
            - name: "è¾¹ç•Œå¤§å°æ–‡ä»¶"
              size: "${config.max_file_size}"
              expected_result: "accept"
            - name: "è¶…å¤§æ–‡ä»¶"
              size: "${config.max_file_size * 2}"
              expected_result: "reject"

        # æ–‡ä»¶æ ¼å¼è¾¹ç•Œæµ‹è¯•
        - action: "test_file_format_boundaries"
          test_cases:
            - name: "æ”¯æŒçš„æ ¼å¼"
              formats: ["jpg", "png", "mp4", "txt"]
              expected_result: "accept"
            - name: "ä¸æ”¯æŒçš„æ ¼å¼"
              formats: ["exe", "bat", "sh", "ps1"]
              expected_result: "reject"
            - name: "ä¼ªé€ æ‰©å±•å"
              original_format: "exe"
              fake_extension: "jpg"
              expected_result: "detect_and_reject"

        - action: "screenshot"
          name: "file_boundary_completed"
          save_path: "screenshots/boundary/file_boundary.png"

    # åœºæ™¯3: èµ„æºçº¦æŸæµ‹è¯•
    - name: "resource_constraint_test"
      description: "æµ‹è¯•ç³»ç»Ÿåœ¨èµ„æºå—é™æƒ…å†µä¸‹çš„è¡Œä¸º"
      steps:
        # å†…å­˜çº¦æŸæµ‹è¯•
        - action: "simulate_memory_constraint"
          scenarios:
            - name: "ä½å†…å­˜è­¦å‘Š"
              available_memory: "256MB"
              expected_behavior: "graceful_degradation"
            - name: "å†…å­˜ä¸è¶³"
              available_memory: "64MB"
              expected_behavior: "emergency_mode"
            - name: "å†…å­˜è€—å°½"
              available_memory: "16MB"
              expected_behavior: "shutdown_safely"

        # ç½‘ç»œçº¦æŸæµ‹è¯•
        - action: "simulate_network_constraint"
          scenarios:
            - name: "æ…¢é€Ÿç½‘ç»œ"
              bandwidth: "56Kbps"
              latency: "1000ms"
              expected_behavior: "adaptive_loading"
            - name: "ä¸ç¨³å®šç½‘ç»œ"
              packet_loss: "10%"
              jitter: "200ms"
              expected_behavior: "retry_with_backoff"
            - name: "ç½‘ç»œä¸­æ–­"
              connectivity: "none"
              duration: "30s"
              expected_behavior: "offline_mode"

        # å­˜å‚¨çº¦æŸæµ‹è¯•
        - action: "simulate_storage_constraint"
          scenarios:
            - name: "å­˜å‚¨ç©ºé—´ä¸è¶³"
              available_space: "100MB"
              expected_behavior: "cleanup_and_continue"
            - name: "å­˜å‚¨ç©ºé—´è€—å°½"
              available_space: "10MB"
              expected_behavior: "readonly_mode"

        - action: "screenshot"
          name: "resource_constraint_completed"
          save_path: "screenshots/boundary/resource_constraint.png"

    # åœºæ™¯4: å¹¶å‘ç”¨æˆ·è¾¹ç•Œæµ‹è¯•
    - name: "concurrent_user_boundary_test"
      description: "æµ‹è¯•ç³»ç»Ÿåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹çš„è¾¹ç•Œè¡¨ç°"
      steps:
        - action: "establish_concurrent_baseline"
          concurrent_users: 1
          operations_per_user: 10

        - action: "test_concurrent_boundaries"
          scenarios:
            - name: "ä¸­ç­‰å¹¶å‘"
              concurrent_users: 50
              operations_per_user: 5
              expected_success_rate: "95%"
            - name: "é«˜å¹¶å‘"
              concurrent_users: 100
              operations_per_user: 3
              expected_success_rate: "85%"
            - name: "æé™å¹¶å‘"
              concurrent_users: 200
              operations_per_user: 1
              expected_success_rate: "70%"

        - action: "verify_system_stability"
          check_memory_leaks: true
          check_resource_cleanup: true
          verify_error_handling: true

        - action: "screenshot"
          name: "concurrent_boundary_completed"
          save_path: "screenshots/boundary/concurrent_boundary.png"

    # åœºæ™¯5: æ—¶é—´è¾¹ç•Œæµ‹è¯•
    - name: "time_boundary_test"
      description: "æµ‹è¯•ä¸æ—¶é—´ç›¸å…³çš„è¾¹ç•Œæ¡ä»¶"
      steps:
        # è¶…æ—¶è¾¹ç•Œæµ‹è¯•
        - action: "test_timeout_boundaries"
          test_cases:
            - name: "æ­£å¸¸æ“ä½œæ—¶é—´"
              operation_duration: "5s"
              expected_behavior: "normal_completion"
            - name: "è¾¹ç•Œè¶…æ—¶"
              operation_duration: "${config.default_timeout}"
              expected_behavior: "timeout_warning"
            - name: "ä¸¥é‡è¶…æ—¶"
              operation_duration: "${config.default_timeout * 2}"
              expected_behavior: "force_timeout"

        # æ—¶é—´æˆ³è¾¹ç•Œæµ‹è¯•
        - action: "test_timestamp_boundaries"
          test_cases:
            - name: "æœ€å°æ—¶é—´æˆ³"
              timestamp: "1970-01-01T00:00:00Z"
              expected_result: "accept"
            - name: "æœ€å¤§æ—¶é—´æˆ³"
              timestamp: "2038-01-19T03:14:07Z"
              expected_result: "accept"
            - name: "æ— æ•ˆæ—¶é—´æˆ³"
              timestamp: "invalid-date"
              expected_result: "reject"

        # æ—¶åŒºè¾¹ç•Œæµ‹è¯•
        - action: "test_timezone_boundaries"
          test_cases:
            - name: "UTCæ—¶åŒº"
              timezone: "UTC"
              expected_result: "accept"
            - name: "æç«¯æ—¶åŒº"
              timezone: "UTC+14"
              expected_result: "accept"
            - name: "æ— æ•ˆæ—¶åŒº"
              timezone: "Invalid/Timezone"
              expected_result: "fallback_to_default"

        - action: "screenshot"
          name: "time_boundary_completed"
          save_path: "screenshots/boundary/time_boundary.png"

    # åœºæ™¯6: æ•°æ®é‡è¾¹ç•Œæµ‹è¯•
    - name: "data_volume_boundary_test"
      description: "æµ‹è¯•å¤§æ•°æ®é‡å¤„ç†çš„è¾¹ç•Œæ¡ä»¶"
      steps:
        # æ•°æ®é›†å¤§å°è¾¹ç•Œ
        - action: "test_data_volume_boundaries"
          test_cases:
            - name: "ç©ºæ•°æ®é›†"
              record_count: 0
              expected_result: "graceful_handling"
            - name: "å•æ¡è®°å½•"
              record_count: 1
              expected_result: "normal_processing"
            - name: "å¤§æ•°æ®é›†"
              record_count: 10000
              expected_result: "batch_processing"
            - name: "è¶…å¤§æ•°æ®é›†"
              record_count: 100000
              expected_result: "streaming_or_reject"

        # æ•°æ®ç»“æ„å¤æ‚åº¦è¾¹ç•Œ
        - action: "test_structure_complexity_boundaries"
          test_cases:
            - name: "ç®€å•ç»“æ„"
              nesting_depth: 1
              field_count: 5
              expected_result: "normal"
            - name: "æ·±å±‚åµŒå¥—"
              nesting_depth: 10
              field_count: 100
              expected_result: "slow_but_acceptable"
            - name: "è¿‡åº¦å¤æ‚"
              nesting_depth: 50
              field_count: 1000
              expected_result: "reject_or_simplify"

        - action: "screenshot"
          name: "data_volume_boundary_completed"
          save_path: "screenshots/boundary/data_volume_boundary.png"

    # åœºæ™¯7: é”™è¯¯æ¢å¤è¾¹ç•Œæµ‹è¯•
    - name: "error_recovery_boundary_test"
      description: "æµ‹è¯•å„ç§é”™è¯¯æƒ…å†µä¸‹çš„æ¢å¤èƒ½åŠ›è¾¹ç•Œ"
      steps:
        # è¿ç»­é”™è¯¯æ¢å¤æµ‹è¯•
        - action: "test_consecutive_error_recovery"
          error_sequence:
            - type: "network_error"
              count: 3
              expected_recovery: "automatic"
            - type: "server_error"
              count: 2
              expected_recovery: "retry_with_backoff"
            - type: "client_error"
              count: 1
              expected_recovery: "user_intervention_required"

        # éƒ¨åˆ†ç³»ç»Ÿæ•…éšœæ¢å¤
        - action: "test_partial_system_failure"
          failure_scenarios:
            - name: "æ•°æ®åº“è¿æ¥å¤±è´¥"
              affected_components: ["data_persistence"]
              expected_fallback: "cache_only_mode"
            - name: "æ–‡ä»¶å­˜å‚¨å¤±è´¥"
              affected_components: ["file_upload", "export"]
              expected_fallback: "disable_affected_features"
            - name: "AIæœåŠ¡å¤±è´¥"
              affected_components: ["content_generation"]
              expected_fallback: "manual_input_mode"

        # çº§è”æ•…éšœæµ‹è¯•
        - action: "test_cascading_failure"
          initial_failure: "authentication_service"
          expected_cascade_prevention: true
          isolation_mechanisms: ["circuit_breaker", "bulkhead_pattern"]

        - action: "screenshot"
          name: "error_recovery_boundary_completed"
          save_path: "screenshots/boundary/error_recovery_boundary.png"

  # è¾¹ç•Œæ¡ä»¶æˆåŠŸæ ‡å‡†
  success_criteria:
    - "æ‰€æœ‰è¾“å…¥è¾¹ç•Œæ¡ä»¶éƒ½å¾—åˆ°æ­£ç¡®å¤„ç†"
    - "æ–‡ä»¶å¤§å°å’Œæ ¼å¼è¾¹ç•ŒéªŒè¯æœ‰æ•ˆ"
    - "èµ„æºçº¦æŸä¸‹ç³»ç»Ÿè¡¨ç°ç¨³å®š"
    - "å¹¶å‘ç”¨æˆ·è¾¹ç•Œæµ‹è¯•åœ¨å¯æ¥å—èŒƒå›´å†…"
    - "æ—¶é—´ç›¸å…³è¾¹ç•Œæ¡ä»¶å¤„ç†æ­£ç¡®"
    - "å¤§æ•°æ®é‡å¤„ç†ä¸ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒ"
    - "é”™è¯¯æ¢å¤æœºåˆ¶åœ¨è¾¹ç•Œæ¡ä»¶ä¸‹æœ‰æ•ˆ"
    - "æ‰€æœ‰æµ‹è¯•åœºæ™¯éƒ½æœ‰æˆªå›¾è®°å½•"

  # è¾¹ç•Œæµ‹è¯•é”™è¯¯å¤„ç†
  error_recovery:
    boundary_strategies:
      - name: "graceful_degradation"
        trigger: "resource_constraint"
        actions: ["disable_non_essential_features", "reduce_quality", "increase_cache_usage"]

      - name: "fallback_to_default"
        trigger: "invalid_input"
        actions: ["clear_invalid_input", "show_help_message", "restore_last_valid_state"]

      - name: "emergency_shutdown"
        trigger: "critical_failure"
        actions: ["save_critical_data", "graceful_termination", "error_reporting"]

    failure_analysis:
      - action: "categorize_boundary_failure"
        categories: ["input_validation", "resource_constraint", "performance_limit", "system_error"]

      - action: "identify_boundary_threshold"
        record_breaking_point: true
        suggest_adjustments: true

  # è¾¹ç•Œæµ‹è¯•æ•°æ®æ”¶é›†
  data_collection:
    enabled: true
    boundary_metrics:
      - "maximum_acceptable_input_length"
      - "minimum_required_resources"
      - "maximum_concurrent_users"
      - "timeout_thresholds"
      - "data_volume_limits"
      - "error_recovery_success_rate"

    monitoring:
      - "resource_usage_at_boundaries"
      - "response_time_degradation"
      - "error_frequency_patterns"
      - "recovery_time_metrics"

  # è¾¹ç•Œæµ‹è¯•æŠ¥å‘Š
  reporting:
    include_boundary_analysis: true
    include_threshold_identification: true
    include_recommendations: true
    include_performance_impact: true
    output_formats: ["json", "html", "markdown"]